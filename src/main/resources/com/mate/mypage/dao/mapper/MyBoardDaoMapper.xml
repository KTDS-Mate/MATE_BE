<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mate.mypage.dao.MyBoardDao">

	<resultMap  id="MyBoardVOMap" 
				type="com.mate.mypage.vo.MyBoardVO"
				autoMapping="true">
		<id column="ID" property="id" />
		
		<association property="memberVO" 
					 javaType="com.mate.user.vo.UserVO"
					 autoMapping="true">
			<!-- MemberVO 클래스와 맵핑된 MEMBERS 테이블의 PK 컬럼을 id 태그로 사용 -->
			<id column="USR_ID" property="usrId" />
			<!-- <result column="NAME" property="name" /> -->
		</association>
	</resultMap>
	
	<sql id="selectAllBoardCondition">
	WHERE 1 = 1
	<if test='searchKeyword != null and searchKeyword != ""'>
		<if test="searchType == 'boardId'">
		AND B.ID =#{searchKeyword}
		</if>
		
		<if test="searchType == 'subject'">
		AND B.SUBJECT LIKE '%' || #{searchKeyword} || '%'
		</if>
		
		<if test="searchType == 'content'">
		AND B.CONTENT LIKE '%' || #{searchKeyword} || '%'
		</if>
		<if test="searchType == 'subject+content'">
		AND (AND B.SUBJECT LIKE '%' || #{searchKeyword} || '%'
		OR B.CONTENT LIKE '%' || #{searchKeyword} || '%')
		</if>
		
		<if test="searchType == 'name'">
		AND M.NAME LIKE '%' || #{searchKeyword} || '%'
		</if>
		
		<if test="searchType == 'email'">
		AND M.EMAIL LIKE '%' || #{searchKeyword} || '%'
		</if>
	</if> 
	</sql>




	<select id="selectBoardCount" parameterType="string" resultType="_int">
		SELECT 
			COUNT(1)
		FROM 
			GD_TR_RCRT 
		WHERE 
			ATHR_ID = #{_parameter}
	</select>


    <select id="selectGDMyAllBoard" parameterType="string" resultType="com.mate.mypage.vo.MyBoardVO">
        SELECT
	        GD_TR_PST_ID
			,ATHR_ID
			,USR_ID
			,GD_TR_TTL
			,TO_CHAR(GD_TR_ST_DT , 'YYYY-MM-DD HH24:MI') GD_TR_ST_DT
			,TO_CHAR(GD_TR_ED_DT , 'YYYY-MM-DD HH24:MI') GD_TR_ED_DT
			,GD_TR_PRPS
			,GD_TR_MP
			,GD_TR_PRC
			,GD_TR_SMRY
			,TO_CHAR(GD_TR_RSTR_DT , 'YYYY-MM-DD HH24:MI') GD_TR_RSTR_DT
			,TO_CHAR(GD_TR_MDFY_DT , 'YYYY-MM-DD HH24:MI') GD_TR_MDFY_DT
			,TO_CHAR(GD_TR_DLT_DT , 'YYYY-MM-DD HH24:MI') GD_TR_DLT_DT
			,GD_TR_IS_DLT
			,TR_CT_ID
			,GD_TR_MX_NP
        FROM
        	GD_TR_RCRT
        WHERE
        	ATHR_ID = #{_parameter}  
    </select>
    

	<delete id="deleteGDBoard" parameterType="string">
	DELETE  
		FROM GD_TR_RCRT
	WHERE 
		GD_TR_PST_ID = #{_parameter}
	</delete>
</mapper>