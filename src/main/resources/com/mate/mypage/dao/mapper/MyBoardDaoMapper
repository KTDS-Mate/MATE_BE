<!-- autoMapping 자동으로 column 들을 맵핑해줌 PK작성은 필요 -->
	<resultMap  id="boardVOMap" 
				type="com.ktdsuniversity.edu.hello_spring.bbs.vo.BoardVO"
				autoMapping="true">
		<!-- PK 컬럼은 id 태그를 사용 -->
		<id column="ID" property="id" />
		<!-- 일반 컬럼은 result 태그를 사용 -->
		<!-- <result column="SUBJECT" property="subject" />
		<result column="CONTENT" property="content" />
		<result column="EMAIL" property="email" />
		<result column="VIEW_CNT" property="viewCnt" />
		<result column="CRT_DT" property="crtDt" />
		<result column="MDFY_DT" property="mdfyDt" />
		<result column="FILE_NAME" property="fileName" />
		<result column="ORIGIN_FILE_NAME" property="originFileName" /> -->
		<!-- 1:1 관계의 Has A 인스턴스는 association 태그를 사용 -->
		<association property="memberVO" 
					 javaType="com.ktdsuniversity.edu.hello_spring.member.vo.MemberVO"
					 autoMapping="true">
			<!-- MemberVO 클래스와 맵핑된 MEMBERS 테이블의 PK 컬럼을 id 태그로 사용 -->
			<id column="EMAIL" property="email" />
			<!-- <result column="NAME" property="name" /> -->
		</association>
	</resultMap>
	
	<sql id="selectAllBoardCondition">
	WHERE 1 = 1
	<if test='searchKeyword != null and searchKeyword != ""'>
		<if test="searchType == 'boardId'">
		AND B.ID =#{searchKeyword}
		</if>
		
		<if test="searchType == 'subject'">
		AND B.SUBJECT LIKE '%' || #{searchKeyword} || '%'
		</if>
		
		<if test="searchType == 'content'">
		AND B.CONTENT LIKE '%' || #{searchKeyword} || '%'
		</if>
		<if test="searchType == 'subject+content'">
		AND (AND B.SUBJECT LIKE '%' || #{searchKeyword} || '%'
		OR B.CONTENT LIKE '%' || #{searchKeyword} || '%')
		</if>
		
		<if test="searchType == 'name'">
		AND M.NAME LIKE '%' || #{searchKeyword} || '%'
		</if>
		
		<if test="searchType == 'email'">
		AND M.EMAIL LIKE '%' || #{searchKeyword} || '%'
		</if>
	</if> 
	</sql>
	
	
	
	
	

	<!-- BoardDao의 메소드명과 반환타입 -->
	<select id="selectBoardAllCount"
			parameterType="com.ktdsuniversity.edu.hello_spring.bbs.vo.SearchBoardVO" 
			resultType="_int">
		SELECT COUNT(1)
		  FROM BOARD B
		 INNER JOIN MEMBERS M
		    ON B.EMAIL = M.EMAIL
		<if test="_parameter != null">
		    <include refid="com.ktdsuniversity.edu.hello_spring.bbs.dao.BoardDao.selectAllBoardCondition"/>
		</if>
	</select>
	<!-- List 는 경로를 적어줘야 함 -->
    <select id="selectAllBoard" 
    		parameterType="com.ktdsuniversity.edu.hello_spring.bbs.vo.SearchBoardVO"
    		resultMap="boardVOMap">
    <if test="_parameter != null">
    	 <include refid="Common.pagination_header"></include>
    </if>
    SELECT   B.ID
		   , B.SUBJECT
		   , B.CONTENT
		   , B.EMAIL
		   , B.VIEW_CNT
		   , TO_CHAR(B.CRT_DT, 'YYYY-MM-DD') CRT_DT
		   , TO_CHAR(B.MDFY_DT, 'YYYY-MM-DD') MDFY_DT
		   , B.FILE_NAME
		   , B.ORIGIN_FILE_NAME
		   , M.NAME
	FROM BOARD B
	INNER JOIN MEMBERS M
		ON B.EMAIL = M.EMAIL
	<if test="_parameter != null">
		<include refid="com.ktdsuniversity.edu.hello_spring.bbs.dao.BoardDao.selectAllBoardCondition"/>
	</if>
	ORDER BY ID DESC 
	<if test="_parameter != null">
			<include refid="Common.pagination_footer"></include>					
    </if>
    	
		
    </select>